{"ast":null,"code":"// Central API base configuration\nimport axios from'axios';import{useI18n}from'./i18n';// Dinamik: nëse nuk ka REACT_APP_API_BASE, përdor host-in aktual (p.sh. IP LAN) me port 4000\nconst dynamicBase=(()=>{if(typeof window==='undefined')return'http://localhost:4000';const host=window.location.hostname;// mund të jetë 192.168.x.x ose localhost\nreturn\"\".concat(window.location.protocol,\"//\").concat(host,\":4000\");})();export const API_BASE=process.env.REACT_APP_API_BASE||dynamicBase;// Always send cookies (session) to backend\naxios.defaults.withCredentials=true;export const withBase=path=>\"\".concat(API_BASE).concat(path);// Simple global listeners (attached once) to dispatch custom events on network status\nif(typeof window!=='undefined'){window.addEventListener('online',()=>document.dispatchEvent(new CustomEvent('app:online')));window.addEventListener('offline',()=>document.dispatchEvent(new CustomEvent('app:offline')));}// Axios response interceptor for network errors\naxios.interceptors.response.use(r=>r,err=>{if(err.message==='Network Error'||!err.response){document.dispatchEvent(new CustomEvent('app:network-error',{detail:err}));}return Promise.reject(err);});// Hook for components to subscribe to network events (optional usage)\nexport function useNetworkStatus(){const{t}=(useI18n===null||useI18n===void 0?void 0:useI18n())||{t:k=>k};const[online,setOnline]=React.useState(typeof navigator!=='undefined'?navigator.onLine:true);const[banner,setBanner]=React.useState(null);React.useEffect(()=>{const onOn=()=>{setOnline(true);setBanner(t('online_banner'));setTimeout(()=>setBanner(null),2500);};const onOff=()=>{setOnline(false);setBanner(t('offline_banner'));};document.addEventListener('app:online',onOn);document.addEventListener('app:offline',onOff);return()=>{document.removeEventListener('app:online',onOn);document.removeEventListener('app:offline',onOff);};},[t]);return{online,banner};}","map":{"version":3,"names":["axios","useI18n","dynamicBase","window","host","location","hostname","concat","protocol","API_BASE","process","env","REACT_APP_API_BASE","defaults","withCredentials","withBase","path","addEventListener","document","dispatchEvent","CustomEvent","interceptors","response","use","r","err","message","detail","Promise","reject","useNetworkStatus","t","k","online","setOnline","React","useState","navigator","onLine","banner","setBanner","useEffect","onOn","setTimeout","onOff","removeEventListener"],"sources":["C:/Users/Admin/Desktop/enisi/frontend/src/api.js"],"sourcesContent":["// Central API base configuration\r\nimport axios from 'axios';\r\nimport { useI18n } from './i18n';\r\n// Dinamik: nëse nuk ka REACT_APP_API_BASE, përdor host-in aktual (p.sh. IP LAN) me port 4000\r\nconst dynamicBase = (() => {\r\n\tif (typeof window === 'undefined') return 'http://localhost:4000';\r\n\tconst host = window.location.hostname; // mund të jetë 192.168.x.x ose localhost\r\n\treturn `${window.location.protocol}//${host}:4000`;\r\n})();\r\nexport const API_BASE = process.env.REACT_APP_API_BASE || dynamicBase;\r\n// Always send cookies (session) to backend\r\naxios.defaults.withCredentials = true;\r\nexport const withBase = (path) => `${API_BASE}${path}`;\r\n\r\n// Simple global listeners (attached once) to dispatch custom events on network status\r\nif (typeof window !== 'undefined') {\r\n\twindow.addEventListener('online', () => document.dispatchEvent(new CustomEvent('app:online')));\r\n\twindow.addEventListener('offline', () => document.dispatchEvent(new CustomEvent('app:offline')));\r\n}\r\n\r\n// Axios response interceptor for network errors\r\naxios.interceptors.response.use(\r\n\tr => r,\r\n\terr => {\r\n\t\tif (err.message === 'Network Error' || !err.response) {\r\n\t\t\tdocument.dispatchEvent(new CustomEvent('app:network-error', { detail: err }));\r\n\t\t}\r\n\t\treturn Promise.reject(err);\r\n\t}\r\n);\r\n\r\n// Hook for components to subscribe to network events (optional usage)\r\nexport function useNetworkStatus(){\r\n\tconst { t } = useI18n?.() || { t: (k)=>k };\r\n\tconst [online, setOnline] = React.useState(typeof navigator !== 'undefined' ? navigator.onLine : true);\r\n\tconst [banner, setBanner] = React.useState(null);\r\n\tReact.useEffect(()=>{\r\n\t\tconst onOn = () => { setOnline(true); setBanner(t('online_banner')); setTimeout(()=>setBanner(null), 2500); };\r\n\t\tconst onOff = () => { setOnline(false); setBanner(t('offline_banner')); };\r\n\t\tdocument.addEventListener('app:online', onOn);\r\n\t\tdocument.addEventListener('app:offline', onOff);\r\n\t\treturn () => { document.removeEventListener('app:online', onOn); document.removeEventListener('app:offline', onOff); };\r\n\t}, [t]);\r\n\treturn { online, banner };\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}